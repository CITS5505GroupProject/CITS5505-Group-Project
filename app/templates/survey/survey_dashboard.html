<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bootstrap Search and Filter Example</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
<style>
    /* Additional custom styling if needed */
    .item {
        padding: 10px;
        margin-bottom: 10px;
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 5px;
    }
    .hidden { display: none; }
    .chart-container {
        width: 100%; 
        height: 300px; 
        background-color: #f8f9fa;
        border-radius: 0.25rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #333;
        font-size: 1.25rem;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }
</style>
</head>
<body>

<div class="container mt-5">
    <!-- Search Bar -->
    <div class="mb-3">
        <input type="text" class="form-control form-control-lg" id="searchInput" onkeyup="searchItems()" placeholder="Search for items..." aria-label="Search">
    </div>

<!-- Filter Cloud -->
<div class="d-grid gap-2 d-md-flex justify-content-md-start mb-4">
    <input type="checkbox" class="btn-check" id="btncheckBusiness" autocomplete="off" onclick="filterItems('Business')">
    <label class="btn btn-outline-primary mb-2" for="btncheckBusiness">Business</label>

    <input type="checkbox" class="btn-check" id="btncheckEducation" autocomplete="off" onclick="filterItems('Education')">
    <label class="btn btn-outline-secondary mb-2" for="btncheckEducation">Education</label>

    <input type="checkbox" class="btn-check" id="btncheckHealthcare" autocomplete="off" onclick="filterItems('Healthcare')">
    <label class="btn btn-outline-success mb-2" for="btncheckHealthcare">Healthcare</label>

    <input type="checkbox" class="btn-check" id="btncheckTechnology" autocomplete="off" onclick="filterItems('Technology')">
    <label class="btn btn-outline-info mb-2" for="btncheckTechnology">Technology</label>

    <input type="checkbox" class="btn-check" id="btncheckEntertainment" autocomplete="off" onclick="filterItems('Entertainment')">
    <label class="btn btn-outline-warning mb-2" for="btncheckEntertainment">Entertainment</label>

    <input type="checkbox" class="btn-check" id="btncheckSocialPolitical" autocomplete="off" onclick="filterItems('SocialPolitical')">
    <label class="btn btn-outline-danger mb-2" for="btncheckSocialPolitical">Social and Political</label>

    <input type="checkbox" class="btn-check" id="btncheckScienceEnvironment" autocomplete="off" onclick="filterItems('ScienceEnvironment')">
    <label class="btn btn-outline-dark mb-2" for="btncheckScienceEnvironment">Science and Environment</label>

    <input type="checkbox" class="btn-check" id="btncheckPersonalDevelopment" autocomplete="off" onclick="filterItems('PersonalDevelopment')">
    <label class="btn btn-outline-light mb-2" for="btncheckPersonalDevelopment">Personal Development</label>
</div>


<!-- Content Containers -->
{% for survey in surveys %}
    <div class="container py-5">
        <div class="card">
            <div class="card-header">
                <div class="d-flex align-items-center">
                    <img src="https://via.placeholder.com/50" class="rounded-circle me-2" alt="User">
                    <div>
                        <h6 class="mb-0">{{ survey.creator.username }}</h6>
                        <small class="text-muted">{{ survey.created_at }}</small>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <p class="card-text">
                    <span id="initialContent">Here is the content of a typical post. Users might share updates, images, or videos here. Lorem ipsum dolor sit amet...</span>
                    <span id="additionalContent" class="hidden">
                        Continued content that goes on. Consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                    </span>
                </p>
                <button class="btn btn-primary" id="viewMore">View More</button>
            </div>
            <div class="card-footer d-flex justify-content-between align-items-center">
                <div class="btn-group" role="group" aria-label="Rating">
                    <button type="button" class="btn btn-outline-warning" onclick="setRating(1)"><i class="bi bi-star-fill"></i></button>
                    <button type="button" class="btn btn-outline-warning" onclick="setRating(2)"><i class="bi bi-star-fill"></i></button>
                    <button type="button" class="btn btn-outline-warning" onclick="setRating(3)"><i class="bi bi-star-fill"></i></button>
                    <button type="button" class="btn btn-outline-warning" onclick="setRating(4)"><i class="bi bi-star-fill"></i></button>
                    <button type="button" class="btn btn-outline-warning" onclick="setRating(5)"><i class="bi bi-star-fill"></i></button>
                </div>
                <button class="btn btn-info" id="viewResults">View Results</button>
            </div>
        </div>
        <div class="card hidden" id="results">
            <div class="card-header">
                <h5>Results Visualization</h5>
            </div>
            <div class="card-body">
                <div class="chart-container">
                    Placeholder for Chart (e.g., 60% Positive)
                </div>
            </div>
        </div>
    </div>
{{ endfor }}


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function handleKeyPress(event) {
        if (event.key === 'Enter') {
            searchItems();
        }
    }
    
    function searchItems() {
        let input = document.getElementById('searchInput').value.toUpperCase();
        let items = document.getElementsByClassName('item');
        let isAnyChecked = Array.from(document.querySelectorAll('.btn-check')).some(checkbox => checkbox.checked);
    
        for (let i = 0; i < items.length; i++) {
            if (items[i].textContent.toUpperCase().indexOf(input) > -1) {
                if (!isAnyChecked || items[i].classList.contains(Array.from(document.querySelectorAll('.btn-check:checked')).map(cb => cb.getAttribute('onclick').match(/'([^']+)'/)[1]).find(c => items[i].classList.contains(c)))) {
                    items[i].style.display = "";
                } else {
                    items[i].style.display = "none";
                }
            } else {
                items[i].style.display = "none";
            }
        }
    }
    
    function filterItems(category) {
        let items = document.getElementsByClassName('item');
        let checkbox = document.getElementById('btncheck' + category[category.length - 1]);
        let isAnyChecked = Array.from(document.querySelectorAll('.btn-check')).some(checkbox => checkbox.checked);
    
        for (let i = 0; i < items.length; i++) {
            if (isAnyChecked) {
                if (items[i].classList.contains(category) && checkbox.checked) {
                    items[i].style.display = "";
                } else {
                    items[i].style.display = "none";
                }
            } else {
                items[i].style.display = ""; // Show all if no checkbox is checked
            }
        }
        searchItems(); // Re-apply search filter after category change
    }
    document.getElementById('viewMore').addEventListener('click', function() {
        const additionalContent = document.getElementById('additionalContent');
        additionalContent.classList.toggle('hidden');
    });

    document.getElementById('viewResults').addEventListener('click', function() {
        const resultsDiv = document.getElementById('results');
        resultsDiv.classList.toggle('hidden');
    });

    function setRating(rating) {
        const stars = document.querySelectorAll('.card-footer .btn-outline-warning');
        stars.forEach((star, index) => {
            if (index < rating) {
                star.classList.add('active');
            } else {
                star.classList.remove('active');
            }
        });
    }
</script>
  
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
